<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>【MySQL必知必会】正则表达式</title><meta name="description"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="generator" content="Hexo 5.3.0"></head><body class="is-flex is-flex-direction-column"><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-space-between is-hidden-mobile"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">loannes's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">【MySQL必知必会】正则表达式</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BB%8B%E7%BB%8D"><span class="toc-text">正则表达式介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8EMySQL%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">正则表达式与MySQL的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8D"><span class="toc-text">基本字符匹配</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LIKE%E4%B8%8EREGEXP%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">LIKE与REGEXP的区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E8%A1%8Cor%E5%8C%B9%E9%85%8D"><span class="toc-text">进行or匹配</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%87%A0%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B9%8B%E4%B8%80"><span class="toc-text">匹配几个字符之一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6"><span class="toc-text">匹配特殊字符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%AD%97%E7%AC%A6%E7%B1%BB"><span class="toc-text">匹配字符类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%A4%9A%E4%B8%AA%E5%AE%9E%E4%BE%8B"><span class="toc-text">匹配多个实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E7%AC%A6"><span class="toc-text">定位符</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/MySQL"><i class="tag post-item-tag">MySQL</i></a><a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><i class="tag post-item-tag">正则表达式</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">【MySQL必知必会】正则表达式</h1><time class="has-text-grey" datetime="2019-12-05T14:09:10.000Z">2019-12-05</time><article class="mt-2 post-content"><p><img src="https://i.loli.net/2021/02/05/EwftXpN7Skn12dT.png" alt=""></p>
<h3 id="正则表达式介绍">正则表达式介绍</h3>
<p>正则表达式可用于查找文件，可以在文本块中找到重复的单词。解析URL,处理复杂文本等。</p>
<h3 id="正则表达式与MySQL的关系">正则表达式与MySQL的关系</h3>
<p>通过正则对文本串进行比较来替换LIKE。<br>
见下面例子</p>
<h4 id="基本字符匹配">基本字符匹配</h4>
<p>从first_name这个列中找出所有包含’oo’的行</p>
<pre><code class="language-mysql">SELECT first_name FROM employees WHERE first_name REGEXP 'oo';
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1Pe1l8.png" alt=""></p>
<p>该代码等同于</p>
<pre><code class="language-mysql">SELECT first_name FROM employees WHERE first_name LIKE '%oo%';
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1Pe36S.png" alt=""></p>
<p>目前看下来正则在字符长度比较短的情况下，执行效率比通配符来得低。</p>
<p>看下面的例子：<br>
在salaries表中，查找salary列里匹配<code>.0000</code>。这个<code>.</code>表示匹配任意一个字符，这个是通配符<code>%</code>做不到的。</p>
<pre><code class="language-mysql">SELECT salary FROM salaries WHERE salary REGEXP '.0000';
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1Pms8P.png" alt=""></p>
<h4 id="LIKE与REGEXP的区别">LIKE与REGEXP的区别</h4>
<p>看下面两句代码</p>
<p><strong>code1</strong></p>
<pre><code class="language-mysql">SELECT birth_date FROM employees WHERE birth_date REGEXP '26' ORDER BY birth_date;
</code></pre>
<p><strong>code2</strong></p>
<pre><code class="language-mysql">SELECT birth_date FROM employees WHERE birth_date LIKE '26' ORDER BY birth_date;
</code></pre>
<p><strong>code1</strong> 效果<br>
<img src="https://s2.ax1x.com/2020/01/20/1PnVIA.png" alt=""></p>
<p><strong>code2</strong> 效果</p>
<pre><code class="language-shell">Empty set (0.09 sec)
</code></pre>
<p>会发现LIKE语句去匹配的话返回空数据。<br>
这个就是LIKE与REGEXP的区别。</p>
<p>因为LIKE必须是匹配整个列的，如果不是完全匹配LIKE是找不到它的。而REGEXP则不一样，只要该列中匹配的文本在该列中即可。</p>
<h4 id="进行or匹配">进行or匹配</h4>
<pre><code class="language-mysql">SELECT birth_date FROM employees WHERE birth_date REGEXP '26|27' ORDER BY birth_date;
</code></pre>
<p>匹配所有26号或27号生日的行<br>
<img src="https://s2.ax1x.com/2020/01/20/1Pn6iR.png" alt=""></p>
<h3 id="匹配几个字符之一">匹配几个字符之一</h3>
<pre><code class="language-mysql">SELECT emp_no FROM employees WHERE emp_no REGEXP '1001[123]';
</code></pre>
<p>匹配文本中包含”1001” + [123]中的任意一个。其中[123]也可用[1-3]来表示。</p>
<p><img src="https://s2.ax1x.com/2020/01/20/1Pn7FA.png" alt=""></p>
<p>与or匹配的区别在于：<br>
“1001[123]”匹配的是10011、10012、10013</p>
<p>“10011|2|3”匹配的是10011、2、3</p>
<h3 id="匹配特殊字符">匹配特殊字符</h3>
<p>匹配.、[]|-等特殊字符</p>
<p><strong>匹配 . 字符</strong><br>
特殊字符需要通过<code>\\</code>转义符来表达</p>
<pre><code class="language-mysql">SELECT first_name FROM employees WHERE first_name REGEXP '\\.'
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1Pu1l6.png" alt=""></p>
<p>其他特殊字符</p>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>\\f</td>
<td>换页</td>
</tr>
<tr>
<td>\\n</td>
<td>换行</td>
</tr>
<tr>
<td>\\r</td>
<td>回车</td>
</tr>
<tr>
<td>\\t</td>
<td>制表</td>
</tr>
<tr>
<td>\\v</td>
<td>纵向制表</td>
</tr>
</tbody>
</table>
<h3 id="匹配字符类">匹配字符类</h3>
<table>
<thead>
<tr>
<th>类</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>[:alnum:]</td>
<td>任意字母和数字（同[a-zA-Z0-9])</td>
</tr>
<tr>
<td>[:alpha:]</td>
<td>任意字符(同[a-zA-Z])</td>
</tr>
<tr>
<td>[:blank:]</td>
<td>空格和制表(同[\t])</td>
</tr>
<tr>
<td>[:cntrl:]</td>
<td>ASCII控制字符(ASCII0到31和127)</td>
</tr>
<tr>
<td>[:digit:]</td>
<td>任意数字(同[0-9])</td>
</tr>
<tr>
<td>[:graph:]</td>
<td>与[:print:]相同,但不包括空格</td>
</tr>
<tr>
<td>[:lower:]</td>
<td>任意小写字母(同[a-z])</td>
</tr>
<tr>
<td>[:print:]</td>
<td>任意可打印字符</td>
</tr>
<tr>
<td>[:punct:]</td>
<td>即不在[:alnum:]也不在[:cntrl:]中的任意字符</td>
</tr>
<tr>
<td>[:space:]</td>
<td>包括空格在内的任意空白符(同[\f\n\r\t\v])</td>
</tr>
<tr>
<td>[:upper:]</td>
<td>任意大写字母(同[A-Z])</td>
</tr>
<tr>
<td>[:xdigit:]</td>
<td>任意十六进制数字(同a-fA-F0-9)</td>
</tr>
</tbody>
</table>
<h3 id="匹配多个实例">匹配多个实例</h3>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>0个或多个匹配</td>
</tr>
<tr>
<td>+</td>
<td>1个或多个匹配</td>
</tr>
<tr>
<td>？</td>
<td>0个或一个匹配</td>
</tr>
<tr>
<td>{n}</td>
<td>指定数目的匹配</td>
</tr>
<tr>
<td>{n,}</td>
<td>不少于指定数目的匹配</td>
</tr>
<tr>
<td>{n,m}</td>
<td>匹配数目的范围（m不超过255）</td>
</tr>
</tbody>
</table>
<p>如：<br>
匹配出生年月为10月以后，20日以后的行</p>
<pre><code class="language-mysql">SELECT birth_date FROM employees WHERE birth_date REGEXP '[0-9]&#123;4&#125;\\-1[0-9]?\\-2[0-9]?';
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1PK14s.png" alt=""></p>
<h3 id="定位符">定位符</h3>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>^</td>
<td>文本的开始</td>
</tr>
<tr>
<td>$</td>
<td>文本的结束</td>
</tr>
<tr>
<td>[[:&lt;:]]</td>
<td>词的开始</td>
</tr>
<tr>
<td>[[:&gt;:]]</td>
<td>词的结尾</td>
</tr>
</tbody>
</table>
<p>比方说想找出以0-9数字开头的姓。因为数字必须在开头位置，使用<code>[0-9]</code>就不适合，有时候会出现数字在中间的情况，这样就不匹配了。</p>
<pre><code class="language-mysql">SELECT first_name FROM employees WHERE first_name REGEXP '^[0-9]';
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1PKrCR.png" alt=""></p>
<p>匹配以0-9数字为结尾的姓，也可以通过定位符来解决</p>
<pre><code class="language-mysql">SELECT first_name FROM employees WHERE first_name REGEXP '[0-9]$';
</code></pre>
<p><img src="https://s2.ax1x.com/2020/01/20/1PKs81.png" alt=""></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/notes/%E3%80%90MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%91%E5%88%9B%E5%BB%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5/" title="【MySQL必知必会】创建计算字段"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: 【MySQL必知必会】创建计算字段</span></a><a class="button is-default" href="/notes/%E3%80%90MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%91%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0/" title="【MySQL必知必会】使用数据处理函数"><span class="has-text-weight-semibold">下一页: 【MySQL必知必会】使用数据处理函数</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="fuer4869/fuer4869.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/fuer4869"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> loannes 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>